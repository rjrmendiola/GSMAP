<div id="sidebar-details" class="">
  <div class="pt-6">
    <div class="flex flex-col space-y-1">
      <div class="p-4">
        <div class="group relative text-muted-foreground">
          <div class="text-muted-foreground/50 pointer-events-none absolute m-2" *ngIf="disasterType && disasterType.type == 'landslide'; else noDisasterType">
            <svg-icon src="assets/icons/heroicons/outline/Landslide-Fill--Streamline-Sharp-Fill-Material-Symbols.svg" [svgClass]="'h-5 w-5'"> </svg-icon>
          </div>

          <ng-template #noDisasterType>
            <div class="text-muted-foreground/50 pointer-events-none absolute m-2">
              <svg-icon src="assets/icons/heroicons/outline/Flood-Fill--Streamline-Sharp-Fill-Material-Symbols.svg" [svgClass]="'h-5 w-5'"> </svg-icon>
            </div>
          </ng-template>
          <!-- <div class="flex h-9 cursor-pointer items-center justify-start rounded text-muted-foreground hover:bg-card hover:text-foreground">
            <a class="ml-10 truncate text-sm font-semibold tracking-wide focus:outline-none">
              Barangays Susceptible to Hazards
            </a>
          </div> -->
        </div>
      </div>

      <div class="p-4">
        <!-- Back button -->
        <button
          (click)="clearBarangaySelection()"
          class="mt-4 w-full bg-red-500 hover:bg-red-600 text-xs py-2 px-4 rounded transition-colors">
          Back
        </button>
      </div>

      <div class="p-4 text-muted-foreground text-xs">
        <div class="h-screen scrollbar-thumb-rounded scrollbar-track-rounded grow overflow-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted">

          <!-- NEW: Barangay Details View (when barangay is selected) -->
          <div *ngIf="isShowingBarangayDetails && selectedBarangayData" class="pt-4">
            <div class="bg-card p-4 rounded-lg mb-4 border border-border">
              <h3 class="text-primary font-semibold text-lg mb-4">
                {{ selectedBarangayData.barangay.name }}
              </h3>

              <!-- Barangay Chairman/Captain -->
              <div class="mb-3 pb-3 border-b border-border">
                <div class="text-muted-foreground text-md mb-1">Barangay Captain</div>
                <div class="text-foreground font-medium">
                  {{ selectedBarangayData.chairman?.name || 'Not Available' }}
                </div>
                <div class="text-muted-foreground text-xs" *ngIf="selectedBarangayData.chairman?.position">
                  {{ selectedBarangayData.chairman?.position }}
                </div>
              </div>

              <!-- Area (if available) -->
              <div *ngIf="selectedBarangayData.barangayProfile?.area" class="mb-3 pb-3 border-b border-border">
                <div class="text-muted-foreground text-md mb-1">Area</div>
                <div class="text-foreground font-medium">
                  {{ selectedBarangayData.barangayProfile?.area | number:'1.2-2' }} km²
                </div>
              </div>

              <!-- Population Density (if available) -->
              <div *ngIf="selectedBarangayData.barangayProfile?.population_density" class="mb-3 pb-3 border-b border-border">
                <div class="text-muted-foreground text-md mb-1">Population Density</div>
                <div class="text-foreground font-medium">
                  {{ selectedBarangayData.barangayProfile?.population_density | number:'1.0-0' }} persons/km²
                </div>
              </div>

              <!-- Population (if available) -->
              <div *ngIf="selectedBarangayData.barangayProfile?.population" class="mb-3 pb-3 border-b border-border">
                <div class="text-muted-foreground text-md mb-1">Population</div>
                <div class="text-foreground font-medium">
                  {{ selectedBarangayData.barangayProfile?.population | number:'1.0-0' }}
                </div>
              </div>

              <!-- Livelihood (if available) -->
              <div *ngIf="selectedBarangayData.barangayProfile?.livelihood" class="mb-3 pb-3 border-b border-border">
                <div class="text-muted-foreground text-md mb-1">Livelihood</div>
                <div class="text-foreground font-medium">
                  {{ selectedBarangayData.barangayProfile?.livelihood }}
                </div>
              </div>

              <!-- Nearest Evacuation Centers (Top 5) -->
              <div *ngIf="selectedBarangayData.nearestEvacuationCenters && selectedBarangayData.nearestEvacuationCenters.length > 0" class="mb-3">
                <div class="text-muted-foreground text-md mb-2">Nearest Evacuation Centers (Top {{ selectedBarangayData.nearestEvacuationCenters.length }})</div>

                <!-- List of evacuation centers -->
                <div *ngFor="let center of selectedBarangayData.nearestEvacuationCenters; let i = index"
                     class="bg-muted p-3 rounded mb-2 border-l-4"
                     [ngClass]="{
                       'border-green-500': i === 0,
                       'border-blue-500': i === 1,
                       'border-yellow-500': i === 2,
                       'border-orange-500': i === 3,
                       'border-red-500': i === 4
                     }">
                  <!-- Image (if available) -->
                  <div *ngIf="center?.image" class="mb-2">
                    <img [src]="getEvacuationCenterImageUrl(center.image)"
                         [alt]="center?.name"
                         class="w-full h-12 object-cover rounded shadow-md"
                         >
                  </div>

                  <!-- Placeholder if no image -->
                  <div *ngIf="!center?.image" class="mb-2 bg-muted rounded flex items-center justify-center h-32">
                    <svg class="w-12 h-12 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                    </svg>
                  </div>

                  <div class="flex items-start justify-between mb-1">
                    <div class="text-foreground font-medium text-sm">
                      {{ i + 1 }}. {{ center?.venue }}
                    </div>
                    <div class="text-green-600 font-semibold text-xs">
                      {{ center?.distance | number:'1.2-2' }} km
                    </div>
                  </div>
                  <!-- <div class="text-muted-foreground text-xs" *ngIf="center?.barangay">
                    Barangay: {{ center?.barangay }}
                  </div> -->
                  <div class="text-muted-foreground text-xs" *ngIf="center?.venue">
                    Barangay: {{ center?.barangay?.name.toUpperCase() }}
                  </div>
                  <div class="text-blue-600 text-xs mt-1" *ngIf="center?.barangay_official?.name">
                    Contact: {{ center?.barangay_official?.name }} ({{ center?.barangay_official?.position }})
                  </div>
                </div>
              </div>

              <!-- Fallback for no evacuation centers -->
              <div *ngIf="!selectedBarangayData.nearestEvacuationCenters || selectedBarangayData.nearestEvacuationCenters.length === 0" class="mb-3">
                <div class="text-muted-foreground text-xs mb-1">Nearest Evacuation Centers</div>
                <div class="text-muted-foreground italic">No evacuation centers found</div>
              </div>

              <!-- Back button -->
              <!-- <button
                (click)="clearBarangaySelection()"
                class="mt-4 w-full bg-red-500 hover:bg-red-600 text-muted-foreground font-medium py-2 px-4 rounded transition-colors">
                Back to Hazards Overview
              </button> -->
            </div>
          </div>

          <!-- EXISTING: Default Hazards View (when no barangay selected) -->
          <div *ngIf="!isShowingBarangayDetails">
            <!-- Loading Indicator -->
            <div *ngIf="isLoadingWeather" class="pt-4 text-center">
            <p class="text-primary font-semibold">Loading weather data...</p>
          </div>

          <!-- Weather Overview for All Barangays -->
          <div class="pt-4" *ngIf="!selectedBarangayWeather && weatherData && !isLoadingWeather && !hasSelectedBarangaysWeather">
            <h3 class="text-primary font-semibold mb-4">Current Weather Overview</h3>
            <div class="grid grid-cols-1 gap-4 mb-6">
              <div *ngFor="let barangay of barangayNames" class="bg-card p-3 rounded-lg border border-border">
                <h4 class="text-primary font-medium mb-2">{{ barangay }}</h4>
                <ng-container *ngIf="getCurrentWeatherConditions(barangay) as currentWeather">
                  <div class="grid grid-cols-2 gap-2 text-sm">
                    <div class="text-foreground">
                      <span class="font-medium">Temp:</span> {{ currentWeather.temperature | number:'1.1-1' }}°C
                    </div>
                    <div class="text-foreground">
                      <span class="font-medium">Humidity:</span> {{ currentWeather.humidity | number:'1.0-0' }}%
                    </div>
                    <div class="text-foreground">
                      <span class="font-medium">Rain Chance:</span> {{ currentWeather.precipitationProbability | number:'1.0-0' }}%
                    </div>
                    <div class="text-foreground">
                      <span class="font-medium">Wind:</span> {{ currentWeather.windSpeed | number:'1.1-1' }} km/h
                    </div>
                  </div>
                </ng-container>
                <hr class="my-2 border-border">
                <ng-container *ngIf="getBarangayDetail(barangay) as barangayDetail">
                  <div class="grid grid-cols-2 gap-2 text-sm">
                    <div class="text-foreground">
                      <span class="font-medium">Area:</span> {{ barangayDetail.area }}
                    </div>
                    <div class="text-foreground">
                      <span class="font-medium">Pop. Density:</span> {{ barangayDetail.pop_density }}
                    </div>
                  </div>
                  <div class="grid grid-cols-1 gap-2 text-sm">
                    <div class="text-foreground">
                      <span class="font-medium">Livelihood: </span> {{ barangayDetail.livelihood }}
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>

          <!-- Detailed Weather for Selected Barangay -->
          <div class="pt-4" *ngIf="selectedBarangay && selectedBarangayWeather">
            <h3 class="text-primary font-semibold mb-4">Detailed Forecast - {{ selectedBarangay }}</h3>

            <!-- Current Conditions -->
            <div class="bg-card p-4 rounded-lg mb-4 border border-border">
              <h4 class="text-primary font-medium mb-3">Current Conditions</h4>
              <div class="grid grid-cols-2 gap-3 text-sm">
                <div class="text-foreground">
                  <span class="font-medium">Temperature:</span> {{ selectedBarangayWeather['temperature_2m']?.[0] | number:'1.1-1' }}°C
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Feels Like:</span> {{ selectedBarangayWeather['apparent_temperature']?.[0] | number:'1.1-1' }}°C
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Humidity:</span> {{ selectedBarangayWeather['relative_humidity_2m']?.[0] | number:'1.0-0' }}%
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Dew Point:</span> {{ selectedBarangayWeather['dew_point_2m']?.[0] | number:'1.1-1' }}°C
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Precipitation:</span> {{ selectedBarangayWeather['precipitation_probability']?.[0] | number:'1.0-0' }}%
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Rain:</span> {{ selectedBarangayWeather['rain']?.[0] | number:'1.1-1' }} mm
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Wind Speed:</span> {{ selectedBarangayWeather['wind_speed_10m']?.[0] | number:'1.1-1' }} km/h
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Wind Direction:</span> {{ selectedBarangayWeather['wind_direction_10m']?.[0] | number:'1.0-0' }}°
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Pressure:</span> {{ selectedBarangayWeather['pressure_msl']?.[0] | number:'1.1-1' }} hPa
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Cloud Cover:</span> {{ selectedBarangayWeather['cloudcover']?.[0] | number:'1.0-0' }}%
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Visibility:</span> {{ (selectedBarangayWeather['visibility']?.[0] || 0) / 1000 | number:'1.1-1' }} km
                </div>
                <div class="text-foreground">
                  <span class="font-medium">UV Index:</span> {{ selectedBarangayWeather['uv_index']?.[0] || 'N/A' }}
                </div>
              </div>
            </div>

            <!-- 24-Hour Forecast -->
            <div class="bg-card p-4 rounded-lg mb-4 border border-border">
              <h4 class="text-primary font-medium mb-3">24-Hour Forecast</h4>
              <div class="max-h-64 overflow-y-auto">
                <div *ngFor="let forecast of get24HourForecast(selectedBarangay); let i = index"
                     class="flex justify-between items-center py-2 border-b border-border last:border-b-0">
                  <div class="text-foreground text-sm">
                    {{ forecast.time | date:'MMM d, h:mm a' }}
                  </div>
                  <div class="text-right text-sm">
                    <div class="text-foreground">{{ forecast.temperature | number:'1.1-1' }}°C</div>
                    <div class="text-primary">{{ forecast.precipitationProbability | number:'1.0-0' }}%</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Soil Conditions (if available) -->
            <div class="bg-card p-4 rounded-lg mb-4 border border-border" *ngIf="selectedBarangayWeather?.['soil_temperature_0cm']">
              <h4 class="text-primary font-medium mb-3">Soil Conditions</h4>
              <div class="grid grid-cols-2 gap-3 text-sm">
                <div class="text-foreground">
                  <span class="font-medium">Surface Temp:</span> {{ selectedBarangayWeather['soil_temperature_0cm']?.[0] | number:'1.1-1' }}°C
                </div>
                <div class="text-foreground">
                  <span class="font-medium">6cm Temp:</span> {{ selectedBarangayWeather['soil_temperature_6cm']?.[0] | number:'1.1-1' }}°C
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Surface Moisture:</span> {{ selectedBarangayWeather['soil_moisture_0_to_1cm']?.[0] | number:'1.2-2' }} m³/m³
                </div>
                <div class="text-foreground">
                  <span class="font-medium">Deep Moisture:</span> {{ selectedBarangayWeather['soil_moisture_1_to_3cm']?.[0] | number:'1.2-2' }} m³/m³
                </div>
              </div>
            </div>
          </div>

          <!-- Detailed Weather for Selected Barangays (DSS) -->
          <div *ngIf="isTyphoon || (!disasterType && hasSelectedBarangaysWeather)">
            <div class="pt-4"
              *ngIf="!selectedBarangay && getSelectedBarangaysList().length && !isLoadingWeather">

              <h3 class="text-purple-400 font-semibold mb-4">
                Detailed Forecast – Selected Barangays
              </h3>

              <div class="grid grid-cols-1 gap-6">

                <div *ngFor="let barangayId of getSelectedBarangaysList()"
                    class="bg-gray-900 p-4 rounded-lg border border-gray-700">

                  <h4 class="text-purple-300 font-medium mb-3">
                    {{ getBarangayName(barangayId) }}
                  </h4>

                  <!-- Reuse your existing detailed structure -->
                  <div class="grid grid-cols-2 gap-3 text-sm">
                    <div class="text-gray-300">
                      <span class="font-medium">Temperature:</span>
                      {{ selectedBarangaysWeather[barangayId]['temperature_2m']?.[0] | number:'1.1-1' }}°C
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Humidity:</span>
                      {{ selectedBarangaysWeather[barangayId]['relative_humidity_2m']?.[0] | number:'1.0-0' }}%
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Rain Chance:</span>
                      {{ selectedBarangaysWeather[barangayId]['precipitation_probability']?.[0] | number:'1.0-0' }}%
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Wind:</span>
                      {{ selectedBarangaysWeather[barangayId]['wind_speed_10m']?.[0] | number:'1.1-1' }} km/h
                    </div>
                  </div>

                  <hr class="my-2 text-gray-300">

                  <ng-container *ngIf="getBarangayDetail(getBarangayName(barangayId)) as barangayDetail">
                    <div class="grid grid-cols-2 gap-2 text-sm">
                      <div class="text-gray-300">
                        <span class="font-medium">Area:</span> {{ barangayDetail.area }}
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Pop. Density:</span> {{ barangayDetail.pop_density }}
                      </div>
                    </div>
                    <div class="grid grid-cols-1 gap-2 text-sm">
                      <div class="text-gray-300">
                        <span class="font-medium">Livelihood: </span> {{ barangayDetail.livelihood }}
                      </div>
                    </div>
                  </ng-container>

                </div>

              </div>
            </div>
          </div>

          <div *ngIf="isLandslide">
            <div class="pt-4"
              *ngIf="!selectedBarangay && getSelectedBarangaysList().length && !isLoadingWeather">

              <h3 class="text-purple-400 font-semibold mb-4">
                Detailed Forecast – Selected Barangays
              </h3>

              <div class="grid grid-cols-1 gap-6">

                <div *ngFor="let barangayId of getSelectedBarangaysList()"
                    class="bg-gray-900 p-4 rounded-lg border border-gray-700">

                  <h4 class="text-purple-300 font-medium mb-3">
                    {{ getBarangayName(barangayId) }}
                  </h4>

                  <!-- Reuse your existing detailed structure -->
                  <div class="grid grid-cols-2 gap-3 text-sm">
                    <div class="text-gray-300">
                      <span class="font-medium">Temperature:</span>
                      {{ selectedBarangaysWeather[barangayId]['temperature_2m']?.[0] | number:'1.1-1' }}°C
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Humidity:</span>
                      {{ selectedBarangaysWeather[barangayId]['relative_humidity_2m']?.[0] | number:'1.0-0' }}%
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Rain Chance:</span>
                      {{ selectedBarangaysWeather[barangayId]['precipitation_probability']?.[0] | number:'1.0-0' }}%
                    </div>

                    <div class="text-gray-300">
                      <span class="font-medium">Wind:</span>
                      {{ selectedBarangaysWeather[barangayId]['wind_speed_10m']?.[0] | number:'1.1-1' }} km/h
                    </div>
                  </div>

                  <hr class="my-2">

                  <!-- Current Conditions -->
                  <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <h4 class="text-green-300 font-medium mb-3">Current Conditions</h4>
                    <div class="grid grid-cols-2 gap-3 text-sm">
                      <div class="text-gray-300">
                        <span class="font-medium">Temperature:</span> {{ selectedBarangaysWeather[barangayId]['temperature_2m']?.[0] | number:'1.1-1' }}°C
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Feels Like:</span> {{ selectedBarangaysWeather[barangayId]['apparent_temperature']?.[0] | number:'1.1-1' }}°C
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Humidity:</span> {{ selectedBarangaysWeather[barangayId]['relative_humidity_2m']?.[0] | number:'1.0-0' }}%
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Dew Point:</span> {{ selectedBarangaysWeather[barangayId]['dew_point_2m']?.[0] | number:'1.1-1' }}°C
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Precipitation:</span> {{ selectedBarangaysWeather[barangayId]['precipitation_probability']?.[0] | number:'1.0-0' }}%
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Rain:</span> {{ selectedBarangaysWeather[barangayId]['rain']?.[0] | number:'1.1-1' }} mm
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Wind Speed:</span> {{ selectedBarangaysWeather[barangayId]['wind_speed_10m']?.[0] | number:'1.1-1' }} km/h
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Wind Direction:</span> {{ selectedBarangaysWeather[barangayId]['wind_direction_10m']?.[0] | number:'1.0-0' }}°
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Pressure:</span> {{ selectedBarangaysWeather[barangayId]['pressure_msl']?.[0] | number:'1.1-1' }} hPa
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Cloud Cover:</span> {{ selectedBarangaysWeather[barangayId]['cloudcover']?.[0] | number:'1.0-0' }}%
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Visibility:</span> {{ (selectedBarangaysWeather[barangayId]['visibility']?.[0] || 0) / 1000 | number:'1.1-1' }} km
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">UV Index:</span> {{ selectedBarangaysWeather[barangayId]['uv_index']?.[0] || 'N/A' }}
                      </div>
                    </div>
                  </div>

                  <!-- 24-Hour Forecast -->
                  <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <h4 class="text-green-300 font-medium mb-3">24-Hour Forecast</h4>
                    <div class="max-h-64 overflow-y-auto">
                      <div *ngFor="let forecast of get24HourForecast(getBarangayName(barangayId)); let i = index"
                          class="flex justify-between items-center py-2 border-b border-gray-700 last:border-b-0">
                        <div class="text-gray-300 text-sm">
                          {{ forecast.time | date:'MMM d, h:mm a' }}
                        </div>
                        <div class="text-right text-sm">
                          <div class="text-gray-200">{{ forecast.temperature | number:'1.1-1' }}°C</div>
                          <div class="text-blue-300">{{ forecast.precipitationProbability | number:'1.0-0' }}%</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Soil Conditions (if available) -->
                  <div class="bg-gray-800 p-4 rounded-lg mb-4" *ngIf="selectedBarangaysWeather[barangayId]?.['soil_temperature_0cm']">
                    <h4 class="text-orange-300 font-medium mb-3">Soil Conditions</h4>
                    <div class="grid grid-cols-2 gap-3 text-sm">
                      <div class="text-gray-300">
                        <span class="font-medium">Surface Temp:</span> {{ selectedBarangaysWeather[barangayId]['soil_temperature_0cm']?.[0] | number:'1.1-1' }}°C
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">6cm Temp:</span> {{ selectedBarangaysWeather[barangayId]['soil_temperature_6cm']?.[0] | number:'1.1-1' }}°C
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Surface Moisture:</span> {{ selectedBarangaysWeather[barangayId]['soil_moisture_0_to_1cm']?.[0] | number:'1.2-2' }} m³/m³
                      </div>
                      <div class="text-gray-300">
                        <span class="font-medium">Deep Moisture:</span> {{ selectedBarangaysWeather[barangayId]['soil_moisture_1_to_3cm']?.[0] | number:'1.2-2' }} m³/m³
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Hazard Information Table -->
          <!-- <div class="mt-6">
            <h3 class="text-red-400 font-semibold mb-4">Hazard Risk Assessment</h3>
            <table class="min-w-full">
              <thead>
                <tr>
                  <th class="text-left py-4 px-4 border-b border-gray-800 font-bold text-gray-200">Barangay</th>
                  <th class="text-left py-4 px-4 border-b border-gray-800 font-bold text-gray-200">Risk Factor</th>
                </tr>
              </thead>
              <tbody *ngIf="floodLandslideDetails.length > 0">
                <ng-container *ngFor="let barangayDetails of floodLandslideDetails">
                  <tr class="hover:bg-gray-600 cursor-pointer" (click)="toggleRemarks(barangayDetails)">
                    <td class="py-2 px-4 border-b border-gray-800 text-gray-200">
                      {{ barangayDetails.barangay }}
                      <span *ngIf="selectedBarangay === barangayDetails.barangay" class="ml-2 text-green-400 text-xs">
                        (Selected)
                      </span>
                    </td>
                    <td class="py-2 px-4 border-b border-gray-800" *ngIf="disasterType; else noDisasterType">
                      <div *ngIf="disasterType.type == 'typhoon'">
                        <p class="text-customFloodHigh" *ngIf="disasterType.category == 'category5'">Risk: {{ barangayDetails.flood.risk }} %</p>
                        <p class="text-customFloodModerate" *ngIf="disasterType.category == 'category4' || disasterType.category == 'category3'">Risk: {{ barangayDetails.flood.risk }} %</p>
                        <p class="text-customFloodLow" *ngIf="disasterType.category == 'category2' || disasterType.category == 'category1'">Risk: {{ barangayDetails.flood.risk }} %</p>

                        <p class="text-customFloodHigh" *ngIf="disasterType.category == 'category5'">Flood Level: {{ barangayDetails.flood.level }}</p>
                        <p class="text-customFloodModerate" *ngIf="disasterType.category == 'category4' || disasterType.category == 'category3'">Flood Level: {{ barangayDetails.flood.level }}</p>
                        <p class="text-customFloodLow" *ngIf="disasterType.category == 'category2' || disasterType.category == 'category1'">Flood Level: {{ barangayDetails.flood.level }}</p>
                      </div>
                      <div class="pt-2" *ngIf="disasterType.type == 'landslide'">
                        <p class="text-customLandslideHigh" *ngIf="disasterType.category == 'category5'">Risk: {{ barangayDetails.landslide.risk }} %</p>
                        <p class="text-customLandslideModerate" *ngIf="disasterType.category == 'category4' || disasterType.category == 'category3'">Risk: {{ barangayDetails.landslide.risk }} %</p>
                        <p class="text-customLandslideLow" *ngIf="disasterType.category == 'category2' || disasterType.category == 'category1'">Risk: {{ barangayDetails.landslide.risk }} %</p>

                        <p class="text-customLandslideHigh" *ngIf="disasterType.category == 'category5'">Landslide Level: {{ barangayDetails.landslide.level }}</p>
                        <p class="text-customLandslideModerate" *ngIf="disasterType.category == 'category4' || disasterType.category == 'category3'">Landslide Level: {{ barangayDetails.landslide.level }}</p>
                        <p class="text-customLandslideLow" *ngIf="disasterType.category == 'category2' || disasterType.category == 'category1'">Landslide Level: {{ barangayDetails.landslide.level }}</p>
                      </div>
                    </td>

                    <ng-template #noDisasterType>
                      <td class="py-2 px-4 border-b border-gray-800">
                        <div>
                          <p>Flood Risk: {{ barangayDetails.flood.risk }}%</p>
                          <p>Flood Level: {{ barangayDetails.flood.level }}</p>
                        </div>
                        <div class="pt-2">
                          <p>Landslide Risk: {{ barangayDetails.landslide.risk }}%</p>
                          <p>Landslide Level: {{ barangayDetails.landslide.level }}</p>
                        </div>
                      </td>
                    </ng-template>
                  </tr>
                  <tr [class.hidden]="!barangayDetails.showremarks" class="risk-factors">
                    <td colspan="2" class="py-2 px-4 border-b border-gray-800 text-gray-400">
                      <p class="mb-2 font-bold">Risk Factors</p>
                      <ul *ngFor="let remark of barangayDetails.remarks">
                        <li class="m-2">{{ remark }}</li>
                      </ul>
                    </td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div> -->
          </div> <!-- End of !isShowingBarangayDetails wrapper -->
        </div>
      </div>
    </div>
  </div>
</div>
